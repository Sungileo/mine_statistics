data <- c(10,20,30,40,50)
print(data)
# 데이터 생성
set.seed(123) # 랜덤 시드 고정
data <- rnorm(100, mean = 50, sd = 10) # 평균 50, 표준편차 10인 정규 분포를 따르는 데이터 100개 생성
data
data[:5]
data[1]
data[1:5]
data[1:5]
# 데이터 생성
set.seed(123) # 랜덤 시드 고정
data <- rnorm(100, mean = 50, sd = 10) # 평균 50, 표준편차 10인 정규 분포를 따르는 데이터 100개 생성
data[1:5]
# 도수분포표 생성
breaks <- seq(20, 80, by = 5) # 5 단위로 구간 나누기
freq_table <- table(cut(data, breaks = breaks, right = FALSE))
print(freq_table)
breaks <- seq(20, 80, by = 10) # 10 단위로 구간 나누기
freq_table <- table(cut(data, breaks = breaks, right = FALSE))
print(freq_table)
source("~/.active-rstudio-document", echo=TRUE)
# 히스토그램 생성
hist(data, breaks = breaks, right = FALSE, main = "Histogram of Data", xlab = "Value", ylab = "Frequency", col = "blue", border = "black")
# 히스토그램 생성
hist(data, breaks = breaks, right = FALSE, main = "Histogram of Data", xlab = "Value", ylab = "Frequency")
breaks
1+log(100)
1+log(50)
1+log(1000)
1+log(x = 100,base = 2)
1+log2((100))
1+log(x = 100,base = 2)
1+log(x = 100,base = 2)
1+log2((100))
1+log(x = 100,base = 2)
1+log2(100)
1+log2(100)
data.frame(freq_table)
data <- rnorm(1000, mean = 170,sd = 10)
breaks <- seq(100, 200, by = 10)
freq_table <- table(cut(data, breaks = breaks, right = FALSE))
data.frame(freq_table)
data <- rnorm(1000, mean = 170,sd = 10)
breaks <- seq(130, 200, by = 10)
freq_table <- table(cut(data, breaks = breaks, right = FALSE))
data.frame(freq_table)
data <- rnorm(1000, mean = 170,sd = 10)
breaks <- seq(130, 210, by = 10)
freq_table <- table(cut(data, breaks = breaks, right = FALSE))
data.frame(freq_table)
data <- rnorm(1000, mean = 165,sd = 10)
breaks <- seq(130, 210, by = 10)
freq_table <- table(cut(data, breaks = breaks, right = FALSE))
data.frame(freq_table)
data <- rnorm(1000, mean = 165,sd = 10)
breaks <- seq(120, 200, by = 10)
freq_table <- table(cut(data, breaks = breaks, right = FALSE))
data.frame(freq_table)
data <- rnorm(1000, mean = 165,sd = 10)
breaks <- seq(120, 200, by = 5)
freq_table <- table(cut(data, breaks = breaks, right = FALSE))
data.frame(freq_table)
data <- rnorm(1000, mean = 165,sd = 10)
breaks <- seq(130, 200, by = 5)
freq_table <- table(cut(data, breaks = breaks, right = FALSE))
data.frame(freq_table)
data <- rnorm(1000, mean = 165,sd = 10)
breaks <- seq(120, 210, by = 5)
freq_table <- table(cut(data, breaks = breaks, right = FALSE))
data.frame(freq_table)
data <- rnorm(1000, mean = 165,sd = 10)
breaks <- seq(120, 210, by = 5)
freq_table <- table(cut(data, breaks = breaks, right = FALSE))
data.frame(freq_table)
hist(data, breaks = breaks, right = FALSE, main = "Histogram of Data", xlab = "Value", ylab = "Frequency")
data <- rnorm(1000, mean = 165,sd = 10)
rbind(data, c(1,2,3,4,5))
min(data)
append(data,c(1,2,3,4,5))
min(data)
data <- rnorm(1000, mean = 165,sd = 10)
data <- append(data,c(1,2,3,4,5))
min(data)
data <- rnorm(700, mean = 165,sd = 10)
data <- append(data,rnorm(300, mean = 145, sd=10))
breaks <- seq(120, 210, by = 5)
freq_table <- table(cut(data, breaks = breaks, right = FALSE))
hist(data, breaks = breaks, right = FALSE, main = "Histogram of Data", xlab = "Value", ylab = "Frequency")
data <- rnorm(700, mean = 165,sd = 10)
data <- append(data,rnorm(300, mean = 145, sd=10))
breaks <- seq(120, 210, by = 5)
freq_table <- table(cut(data, breaks = breaks, right = FALSE))
hist(data, breaks = breaks, right = FALSE, main = "Histogram of Data", xlab = "Value", ylab = "Frequency")
freq_table
data <- rnorm(700, mean = 165,sd = 10)
data <- append(data,rnorm(300, mean = 145, sd=5))
breaks <- seq(120, 210, by = 5)
freq_table <- table(cut(data, breaks = breaks, right = FALSE))
hist(data, breaks = breaks, right = FALSE, main = "Histogram of Data", xlab = "Value", ylab = "Frequency")
data <- rnorm(700, mean = 165,sd = 10)
data <- append(data,rnorm(300, mean = 140, sd=5))
breaks <- seq(120, 210, by = 5)
freq_table <- table(cut(data, breaks = breaks, right = FALSE))
hist(data, breaks = breaks, right = FALSE, main = "Histogram of Data", xlab = "Value", ylab = "Frequency")
abline(157)
abline(v = 157, col = "red", lwd = 2, lty = 2)
data <- rnorm(700, mean = 165,sd = 10)
data <- append(data,rnorm(300, mean = 140, sd=5))
breaks <- seq(120, 210, by = 5)
freq_table <- table(cut(data, breaks = breaks, right = FALSE))
hist(data, breaks = breaks, right = FALSE, main = "Histogram of Data", xlab = "Value", ylab = "Frequency")
abline(v = 157, col = "red", lwd = 2, lty = 2)
data <- rnorm(700, mean = 165,sd = 10)
data <- append(data,rnorm(300, mean = 150, sd=3))
breaks <- seq(120, 210, by = 5)
freq_table <- table(cut(data, breaks = breaks, right = FALSE))
hist(data, breaks = breaks, right = FALSE, main = "Histogram of Data", xlab = "Value", ylab = "Frequency")
abline(v = 157, col = "red", lwd = 2, lty = 2)
data <- rnorm(700, mean = 165,sd = 10)
data <- append(data,rnorm(300, mean = 150, sd=5))
breaks <- seq(120, 210, by = 5)
freq_table <- table(cut(data, breaks = breaks, right = FALSE))
hist(data, breaks = breaks, right = FALSE, main = "Histogram of Data", xlab = "Value", ylab = "Frequency")
abline(v = 157, col = "red", lwd = 2, lty = 2)
data <- rnorm(700, mean = 165,sd = 10)
data <- append(data,rnorm(300, mean = 150, sd=5))
breaks <- seq(120, 210, by = 5)
freq_table <- table(cut(data, breaks = breaks, right = FALSE))
hist(data, breaks = breaks, right = FALSE, main = "Histogram of Data", xlab = "Value", ylab = "Frequency")
abline(v = 157, col = "red", lwd = 2, lty = 2)
data <- rnorm(700, mean = 165,sd = 10)
data <- append(data,rnorm(300, mean = 140, sd=5))
breaks <- seq(120, 210, by = 5)
freq_table <- table(cut(data, breaks = breaks, right = FALSE))
hist(data, breaks = breaks, right = FALSE, main = "Histogram of Data", xlab = "Value", ylab = "Frequency")
abline(v = 157, col = "red", lwd = 2, lty = 2)
data <- rnorm(700, mean = 165,sd = 10)
data <- append(data,rnorm(300, mean = 140, sd=5))
breaks <- seq(120, 210, by = 5)
freq_table <- table(cut(data, breaks = breaks, right = FALSE))
hist(data, breaks = breaks, right = FALSE, main = "Histogram of Data", xlab = "Value", ylab = "Frequency")
abline(v = 157, col = "red", lwd = 2, lty = 2)
data <- rnorm(700, mean = 165,sd = 10)
data <- append(data,rnorm(300, mean = 140, sd=5))
breaks <- seq(120, 210, by = 5)
freq_table <- table(cut(data, breaks = breaks, right = FALSE))
hist(data, breaks = breaks, right = FALSE, main = "Histogram of Data", xlab = "Value", ylab = "Frequency")
abline(v = 157, col = "red", lwd = 2, lty = 2)
data <- rnorm(700, mean = 165,sd = 10)
data <- append(data,rnorm(300, mean = 140, sd=5))
breaks <- seq(120, 210, by = 5)
freq_table <- table(cut(data, breaks = breaks, right = FALSE))
hist(data, breaks = breaks, right = FALSE, main = "Histogram of Data", xlab = "Value", ylab = "Frequency")
abline(v = 157, col = "red", lwd = 2, lty = 2)
data <- rnorm(700, mean = 165,sd = 10)
data <- append(data,rnorm(300, mean = 140, sd=5))
breaks <- seq(120, 210, by = 5)
freq_table <- table(cut(data, breaks = breaks, right = FALSE))
hist(data, breaks = breaks, right = FALSE, main = "Histogram of Data", xlab = "Value", ylab = "Frequency")
abline(v = 157, col = "red", lwd = 2, lty = 2)
data <- rnorm(700, mean = 165,sd = 10)
data <- append(data,rnorm(300, mean = 140, sd=5))
breaks <- seq(120, 210, by = 5)
freq_table <- table(cut(data, breaks = breaks, right = FALSE))
hist(data, breaks = breaks, right = FALSE, main = "Histogram of Data", xlab = "Value", ylab = "Frequency")
abline(v = 157, col = "red", lwd = 2, lty = 2)
data <- rnorm(700, mean = 165,sd = 10)
data <- append(data,rnorm(300, mean = 140, sd=5))
breaks <- seq(120, 210, by = 5)
freq_table <- table(cut(data, breaks = breaks, right = FALSE))
hist(data, breaks = breaks, right = FALSE, main = "Histogram of Data", xlab = "Value", ylab = "Frequency")
abline(v = 157, col = "red", lwd = 2, lty = 2)
data <- rnorm(700, mean = 165,sd = 10)
data <- append(data,rnorm(300, mean = 140, sd=5))
breaks <- seq(120, 210, by = 5)
freq_table <- table(cut(data, breaks = breaks, right = FALSE))
hist(data, breaks = breaks, right = FALSE, main = "Histogram of Data", xlab = "Value", ylab = "Frequency")
abline(v = 157, col = "red", lwd = 2, lty = 2)
set.seed(123)
data <- rnorm(700, mean = 165,sd = 10)
data <- append(data,rnorm(300, mean = 140, sd=5))
breaks <- seq(120, 210, by = 5)
freq_table <- table(cut(data, breaks = breaks, right = FALSE))
hist(data, breaks = breaks, right = FALSE, main = "Histogram of Data", xlab = "Value", ylab = "Frequency")
abline(v = 157, col = "red", lwd = 2, lty = 2)
set.seed(123)
data <- rnorm(700, mean = 165,sd = 10)
data <- append(data,rnorm(300, mean = 140, sd=5))
breaks <- seq(120, 210, by = 5)
freq_table <- table(cut(data, breaks = breaks, right = FALSE))
hist(data, breaks = breaks, right = FALSE, main = "Histogram of Data", xlab = "Value", ylab = "Frequency")
abline(v = 157, col = "red", lwd = 2, lty = 2)
set.seed(123)
data <- rnorm(700, mean = 165,sd = 10)
data <- append(data,rnorm(300, mean = 140, sd=5))
breaks <- seq(120, 210, by = 5)
freq_table <- table(cut(data, breaks = breaks, right = FALSE))
hist(data, breaks = breaks, right = FALSE, main = "Histogram of Data", xlab = "Value", ylab = "Frequency")
abline(v = 157, col = "red", lwd = 2, lty = 2)
set.seed(123)
data <- rnorm(700, mean = 165,sd = 10)
data <- append(data,rnorm(300, mean = 140, sd=5))
breaks <- seq(120, 210, by = 5)
freq_table <- table(cut(data, breaks = breaks, right = FALSE))
hist(data, breaks = breaks, right = FALSE, main = "Histogram of Data", xlab = "Value", ylab = "Frequency")
abline(v = 157, col = "red", lwd = 2, lty = 2)
set.seed(123)
data <- rnorm(700, mean = 165,sd = 10)
data <- append(data,rnorm(300, mean = 140, sd=5))
breaks <- seq(120, 210, by = 5)
freq_table <- table(cut(data, breaks = breaks, right = FALSE))
hist(data, breaks = breaks, right = FALSE, main = "Histogram of Data", xlab = "Value", ylab = "Frequency")
abline(v = 157, col = "red", lwd = 2, lty = 2)
set.seed(123)
data <- rnorm(700, mean = 165,sd = 10)
data <- append(data,rnorm(300, mean = 140, sd=5))
breaks <- seq(120, 210, by = 5)
freq_table <- table(cut(data, breaks = breaks, right = FALSE))
hist(data, breaks = breaks, right = FALSE, main = "Histogram of Data", xlab = "Value", ylab = "Frequency")
abline(v = 157, col = "red", lwd = 2, lty = 2)
set.seed(123)
data <- rnorm(700, mean = 165,sd = 10)
data <- append(data,rnorm(300, mean = 140, sd=5))
breaks <- seq(120, 210, by = 5)
freq_table <- table(cut(data, breaks = breaks, right = FALSE))
hist(data, breaks = breaks, right = FALSE, main = "Histogram of Data", xlab = "Value", ylab = "Frequency")
abline(v = 157, col = "red", lwd = 2, lty = 2)
set.seed(123)
data <- rnorm(700, mean = 165,sd = 10)
data <- append(data,rnorm(300, mean = 140, sd=5))
breaks <- seq(120, 210, by = 5)
freq_table <- table(cut(data, breaks = breaks, right = FALSE))
hist(data, breaks = breaks, right = FALSE, main = "Histogram of Data", xlab = "Value", ylab = "Frequency")
abline(v = 157, col = "red", lwd = 2, lty = 2)
set.seed(122)
data <- rnorm(700, mean = 165,sd = 10)
data <- append(data,rnorm(300, mean = 140, sd=5))
breaks <- seq(120, 210, by = 5)
freq_table <- table(cut(data, breaks = breaks, right = FALSE))
hist(data, breaks = breaks, right = FALSE, main = "Histogram of Data", xlab = "Value", ylab = "Frequency")
abline(v = 157, col = "red", lwd = 2, lty = 2)
set.seed(121)
data <- rnorm(700, mean = 165,sd = 10)
data <- append(data,rnorm(300, mean = 140, sd=5))
breaks <- seq(120, 210, by = 5)
freq_table <- table(cut(data, breaks = breaks, right = FALSE))
hist(data, breaks = breaks, right = FALSE, main = "Histogram of Data", xlab = "Value", ylab = "Frequency")
abline(v = 157, col = "red", lwd = 2, lty = 2)
set.seed(120)
data <- rnorm(700, mean = 165,sd = 10)
data <- append(data,rnorm(300, mean = 140, sd=5))
breaks <- seq(120, 210, by = 5)
freq_table <- table(cut(data, breaks = breaks, right = FALSE))
hist(data, breaks = breaks, right = FALSE, main = "Histogram of Data", xlab = "Value", ylab = "Frequency")
abline(v = 157, col = "red", lwd = 2, lty = 2)
set.seed(120)
data <- rnorm(700, mean = 165,sd = 10)
data <- append(data,rnorm(300, mean = 140, sd=5))
breaks <- seq(120, 210, by = 5)
freq_table <- table(cut(data, breaks = breaks, right = FALSE))
hist(data, breaks = breaks, right = FALSE, main = "Histogram of Data", xlab = "Value", ylab = "Frequency")
abline(v = 150, col = "red", lwd = 2, lty = 2)
set.seed(120)
data <- rnorm(700, mean = 165,sd = 10)
data <- append(data,rnorm(300, mean = 140, sd=5))
breaks <- seq(120, 210, by = 5)
freq_table <- table(cut(data, breaks = breaks, right = FALSE))
hist(data, breaks = breaks, right = FALSE, main = "허위신고 키 히스토그램", xlab = "키", ylab = "빈도")
abline(v = 150, col = "red", lwd = 2, lty = 2)
data.frame(c(1,2,3,4),c(1,2,3,4))
data.frame(a = c(1,2,3,4), b = c(1,2,3,4))
data.frame(이유 = c(1,2,3,4),
b = c(1,2,3,4))
data.frame(이유 = c("색이 마음에 듬", "사용하기 쉬움", "향기가 좋음", "갖고 다니기 편함", "귀여움"),
사람_수 = c(10,50,15,5,20))
data <- data.frame(이유 = c("색이 마음에 듬", "사용하기 쉬움", "향기가 좋음", "갖고 다니기 편함", "귀여움"),
사람_수 = c(10,50,15,5,20))
library(dplyr)
data %>% sort()
data %>% arrange()
data %>% arrange(사람_수)
data %>% arrange(-사람_수)
data <- data %>% arrange(-사람_수)
data
data
data %>% mutate(상대도수 = 사람_수/sum(사람_수))
data %>% mutate(상대도수 = 사람_수/sum(사람_수),
누적상대도수 = cumsum(상대도수))
data <- data.frame(이유 = c("색이 마음에 듬", "사용하기 쉬움", "향기가 좋음", "갖고 다니기 편함", "귀여움"),
사람_수 = c(10,50,15,5,20))
data
data %>% kable()
source("~/.active-rstudio-document", echo=TRUE)
library(ggplot2)
# 기본 플롯
p <- ggplot(data, aes(x = reorder(이유, -사람_수), y = 사람_수)) +
geom_bar(stat = "identity", fill = "blue", alpha = 0.7) +
geom_line(aes(y = 누적상대도수 * sum(사람_수)), group = 1, color = "red") +
geom_point(aes(y = 누적상대도수 * sum(사람_수)), color = "red") +
scale_y_continuous(sec.axis = sec_axis(~ . / sum(data$사람_수), name = "누적상대도수")) +
labs(title = "파레토 플롯", x = "이유", y = "사람 수") +
theme_minimal()
# 기본 플롯
p <- ggplot(data, aes(x = reorder(이유, -사람_수), y = 사람_수)) +
geom_bar(stat = "identity", fill = "blue", alpha = 0.7) +
geom_line(aes(y = 누적상대도수 * sum(사람_수)), group = 1, color = "red") +
geom_point(aes(y = 누적상대도수 * sum(사람_수)), color = "red") +
scale_y_continuous(sec.axis = sec_axis(~ . / sum(data$사람_수), name = "누적상대도수")) +
labs(title = "파레토 플롯", x = "이유", y = "사람 수") +
theme_minimal()
data
data <- data %>% arrange(-사람_수)
data <- data.frame(이유 = c("색이 마음에 듬", "사용하기 쉬움", "향기가 좋음", "갖고 다니기 편함", "귀여움"),
사람_수 = c(10,50,15,5,20))
data %>% kable()
data <- data %>% arrange(-사람_수)
data <- data %>% mutate(상대도수 = 사람_수/sum(사람_수),
누적상대도수 = cumsum(상대도수))
# 기본 플롯
p <- ggplot(data, aes(x = reorder(이유, -사람_수), y = 사람_수)) +
geom_bar(stat = "identity", fill = "blue", alpha = 0.7) +
geom_line(aes(y = 누적상대도수 * sum(사람_수)), group = 1, color = "red") +
geom_point(aes(y = 누적상대도수 * sum(사람_수)), color = "red") +
scale_y_continuous(sec.axis = sec_axis(~ . / sum(data$사람_수), name = "누적상대도수")) +
labs(title = "파레토 플롯", x = "이유", y = "사람 수") +
theme_minimal()
p
# 기본 플롯
p <- ggplot(data, aes(x = reorder(이유, -사람_수), y = 사람_수)) +
geom_bar(stat = "identity", fill = "royalblue", alpha = 0.7) +
geom_line(aes(y = 누적상대도수 * sum(사람_수)), group = 1, color = "orange") +
geom_point(aes(y = 누적상대도수 * sum(사람_수)), color = "orange") +
scale_y_continuous(sec.axis = sec_axis(~ . / sum(data$사람_수), name = "누적상대도수")) +
labs(title = "파레토 플롯", x = "이유", y = "사람 수") +
theme_minimal()
p
data <- data.frame(원인 = c('흠집', '휘어짐', '탈색', '누락', '강도_부족', '기타'),
불량품_수 = c(100, 75, 50, 40, 25,40))
data <- data %>% mutate(상대도수 = 사람_수/sum(사람_수),
누적상대도수 = cumsum(상대도수))
data <- data %>% mutate(상대도수 = 사람_수/sum(불량품_수),
누적상대도수 = cumsum(상대도수))
data <- data %>% mutate(상대도수 = 불량품_수/sum(불량품_수),
누적상대도수 = cumsum(상대도수))
data
data %>% ggplot(aes(x=원인, y=불량품_수))+
geom_bar(stat = "identity", fill = "royalblue", alpha =0.7)
data <- data.frame(원인 = c('흠집', '휘어짐', '탈색', '누락', '강도_부족', '기타'),
불량품_수 = c(100, 75, 50, 40, 25,40))
data$원인 <- factor(data$원인, levels = data$원인)
data <- data %>% mutate(상대도수 = 불량품_수/sum(불량품_수),
누적상대도수 = cumsum(상대도수))
ggplot(data, aes(x = reorder(이유, -사람_수), y = 사람_수)) +
geom_bar(stat = "identity", fill = "royalblue", alpha = 0.7) +
geom_line(aes(y = 누적상대도수 * sum(사람_수)), group = 1, color = "orange") +
geom_point(aes(y = 누적상대도수 * sum(사람_수)), color = "orange") +
scale_y_continuous(sec.axis = sec_axis(~ . / sum(data$사람_수), name = "누적상대도수")) +
labs(x = "이유", y = "사람 수") +
theme_minimal()
data <- data.frame(원인 = c('흠집', '휘어짐', '탈색', '누락', '강도_부족', '기타'),
불량품_수 = c(100, 75, 50, 40, 25,40))
data$원인 <- factor(data$원인, levels = data$원인)
data <- data %>% mutate(상대도수 = 불량품_수/sum(불량품_수),
누적상대도수 = cumsum(상대도수))
data %>% ggplot(aes(x=원인, y=불량품_수))+
geom_bar(stat = "identity", fill = "royalblue", alpha =0.7)
data %>% ggplot(aes(x=원인, y=불량품_수))+
geom_bar(stat = "identity", fill = "royalblue", alpha =0.7)+
geom_line(aes(y = 누적상대도수*sum(불량품_수)), group = 1)
data %>% ggplot(aes(x=원인, y=불량품_수))+
geom_bar(stat = "identity", fill = "royalblue", alpha =0.7)+
geom_line(aes(y = 누적상대도수*sum(불량품_수)), group = 1, color = "orange")
data %>% ggplot(aes(x=원인, y=불량품_수))+
geom_bar(stat = "identity", fill = "royalblue", alpha =0.7)+
geom_line(aes(y = 누적상대도수*sum(불량품_수)), group = 1, color = "orange")+
geom_point(aes(y = 누적상대도수*sum(불량품_수)), color = "orange")
data %>% ggplot(aes(x=원인, y=불량품_수))+
geom_bar(stat = "identity", fill = "royalblue", alpha =0.7)+
geom_line(aes(y = 누적상대도수*sum(불량품_수)), group = 1, color = "orange")+
geom_point(aes(y = 누적상대도수*sum(불량품_수)), color = "orange")+
theme_minimal()
data %>% ggplot(aes(x=원인, y=불량품_수))+
geom_bar(stat = "identity", fill = "royalblue", alpha =0.7)+
geom_line(aes(y = 누적상대도수*sum(불량품_수)), group = 1, color = "orange")+
geom_point(aes(y = 누적상대도수*sum(불량품_수)), color = "orange")+
scale_y_continuous(sec.axis = sec_axis(~ . / sum(data$불량품_수), name = "누적상대도수")) +
theme_minimal()
data %>% ggplot(aes(x=원인, y=불량품_수))+
geom_bar(stat = "identity", fill = "royalblue", alpha =0.7)+
geom_line(aes(y = 누적상대도수*sum(불량품_수)), group = 1, color = "orange")+
geom_point(aes(y = 누적상대도수*sum(불량품_수)), color = "orange")+
scale_y_continuous(sec.axis = sec_axis(~ . / sum(data$불량품_수), name = "누적상대도수")) +
labs(x = "원인", y = "불량품 수") +
theme_minimal()
data <- data.frame(음료 = c('생수', '콜라', '녹차', '오렌지주스', '기타'),
판매량 = c(80, 60, 30, 20, 10))
data <- data %>% arrange(판매량)
data <- data %>% mutate(상대도수 = 판매량/sum(판매량),
누적상대도수 = cumsum(상대도수))
data %>% ggplot(aes(x=음료, y=판매량))+
geom_bar(stat = "identity", fill = "royalblue", alpha =0.7)+
geom_line(aes(y = 누적상대도수*sum(판매량)), group = 1, color = "orange")+
geom_point(aes(y = 누적상대도수*sum(판매량)), color = "orange")+
scale_y_continuous(sec.axis = sec_axis(~ . / sum(data$판매량), name = "누적상대도수")) +
labs(x = "원인", y = "불량품 수") +
theme_minimal()
data <- data %>% arrange(판매량)
data <- data.frame(음료 = c('생수', '콜라', '녹차', '오렌지주스', '기타'),
판매량 = c(80, 60, 30, 20, 10))
data <- data %>% arrange(판매량)
data <- data %>% mutate(상대도수 = 판매량/sum(판매량),
누적상대도수 = cumsum(상대도수))
data %>% ggplot(aes(x=음료, y=판매량))+
geom_bar(stat = "identity", fill = "royalblue", alpha =0.7)+
geom_line(aes(y = 누적상대도수*sum(판매량)), group = 1, color = "orange")+
geom_point(aes(y = 누적상대도수*sum(판매량)), color = "orange")+
scale_y_continuous(sec.axis = sec_axis(~ . / sum(data$판매량), name = "누적상대도수")) +
labs(x = "원인", y = "불량품 수") +
theme_minimal()
data %>% ggplot(aes(x=reorder(음료,판매량), y=판매량))+
geom_bar(stat = "identity", fill = "royalblue", alpha =0.7)+
geom_line(aes(y = 누적상대도수*sum(판매량)), group = 1, color = "orange")+
geom_point(aes(y = 누적상대도수*sum(판매량)), color = "orange")+
scale_y_continuous(sec.axis = sec_axis(~ . / sum(data$판매량), name = "누적상대도수")) +
labs(x = "원인", y = "불량품 수") +
theme_minimal()
data %>% ggplot(aes(x=reorder(음료,-판매량), y=판매량))+
geom_bar(stat = "identity", fill = "royalblue", alpha =0.7)+
geom_line(aes(y = 누적상대도수*sum(판매량)), group = 1, color = "orange")+
geom_point(aes(y = 누적상대도수*sum(판매량)), color = "orange")+
scale_y_continuous(sec.axis = sec_axis(~ . / sum(data$판매량), name = "누적상대도수")) +
labs(x = "원인", y = "불량품 수") +
theme_minimal()
data <- data.frame(음료 = c('생수', '콜라', '녹차', '오렌지주스', '기타'),
판매량 = c(80, 60, 30, 20, 10))
data <- data %>% arrange(-판매량)
data <- data %>% mutate(상대도수 = 판매량/sum(판매량),
누적상대도수 = cumsum(상대도수))
data %>% ggplot(aes(x=reorder(음료,-판매량), y=판매량))+
geom_bar(stat = "identity", fill = "royalblue", alpha =0.7)+
geom_line(aes(y = 누적상대도수*sum(판매량)), group = 1, color = "orange")+
geom_point(aes(y = 누적상대도수*sum(판매량)), color = "orange")+
scale_y_continuous(sec.axis = sec_axis(~ . / sum(data$판매량), name = "누적상대도수")) +
labs(x = "원인", y = "불량품 수") +
theme_minimal()
